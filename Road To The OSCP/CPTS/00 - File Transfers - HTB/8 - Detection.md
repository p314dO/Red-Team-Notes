La detección de línea de comandos basada en listas negras es fácil de eludir, incluso utilizando una simple ofuscación de mayúsculas y minúsculas. Sin embargo, aunque el proceso de incluir en la lista blanca todas las líneas de comando en un entorno particular lleva mucho tiempo inicialmente, es muy sólido y permite una detección y alerta rápidas sobre cualquier línea de comando inusual.
La mayoría de los protocolos cliente-servidor requieren que el cliente y el servidor negocien cómo se entregará el contenido antes de intercambiar información. Esto es común con el `HTTP`protocolo. Existe la necesidad de interoperabilidad entre diferentes servidores web y tipos de navegadores web para garantizar que los usuarios tengan la misma experiencia sin importar su navegador. Los clientes HTTP se reconocen más fácilmente por su cadena de agente de usuario, que el servidor utiliza para identificar qué `HTTP` el cliente se está conectando a él, por ejemplo, Firefox, Chrome, etc.
Los agentes de usuario no sólo se utilizan para identificar navegadores web, sino también cualquier cosa que actúe como un `HTTP` cliente y conectarse a un servidor web a través de `HTTP` puede tener una cadena de agente de usuario (es decir, `cURL`, Una costumbre `Python` script o herramientas comunes como `sqlmap`, o `Nmap`).
Las organizaciones pueden tomar algunas medidas para identificar posibles cadenas de agentes de usuario creando primero una lista de cadenas de agentes de usuario legítimas conocidas, agentes de usuario utilizados por los procesos predeterminados del sistema operativo, agentes de usuario comunes utilizados por servicios de actualización como Windows Update y actualizaciones de antivirus, etc. Estos pueden introducirse en una herramienta SIEM utilizada para la búsqueda de amenazas para filtrar el tráfico legítimo y centrarse en anomalías que puedan indicar un comportamiento sospechoso. Cualquier cadena de agente de usuario que parezca sospechosa se puede investigar más a fondo para determinar si se utilizó para realizar acciones maliciosas. Este [sitio web](http://useragentstring.com/index.php) es útil para identificar cadenas de agentes de usuario comunes. Una lista de cadenas de agentes de usuario está disponible [aquí](http://useragentstring.com/pages/useragentstring.php) .
Sus agentes de usuario también pueden detectar transferencias de archivos maliciosos. Se observaron los siguientes agentes de usuario/encabezados desde aplicaciones comunes. `HTTP` técnicas de transferencia (probadas en Windows 10, versión 10.0.14393, con PowerShell 5).